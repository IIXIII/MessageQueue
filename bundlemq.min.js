!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.EntryPoint=n():t.EntryPoint=n()}(this,function(){return function(t){function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var e={};return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=0)}([function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.MQFactory=void 0;var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),o=e(1),s=e(2);n.MQFactory=function(){function t(){i(this,t)}return r(t,[{key:"buildClient",value:function(){var t=new s.RabbitWrapper;return new o.AgentRabbit(t.getRabbit())}}]),t}()},function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),o=null;n.AgentRabbit=function(){function t(n){return i(this,t),o||(this.connected=!1,this.rabbitmq=n,this.rabbitmq.subscribe(this),o=this,this.MQParameter={onDisconnected:function(){},onConnected:function(){},onMessage:function(t){}}),o}return r(t,[{key:"connectToRabbit",value:function(t){this.connected||(this.rabbitTopics=t,this.rabbitmq.connectToRabbit())}},{key:"onConnected",value:function(){this.rabbitTopics&&""!==this.rabbitTopics&&(this.rabbitmq.subscribeTopics(this.rabbitTopics),this.rabbitTopics=""),this.connected=!0,this.MQParameter.onConnected()}},{key:"onDisconnected",value:function(){this.connected=!1,this.MQParameter.onDisconnected()}},{key:"subscribeTopics",value:function(t){this.rabbitmq.subscribeTopics(t)}},{key:"unsubscribeTopics",value:function(t){this.rabbitmq.unsubscribeTopics(t)}},{key:"sendMessage",value:function(t,n){this.rabbitmq.sendMessage(t,n)}},{key:"onMessage",value:function(t){this.MQParameter.onMessage(t)}}]),t}()},function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.RabbitWrapper=void 0;var r=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),o=e(3);n.RabbitWrapper=function(){function t(){i(this,t)}return r(t,[{key:"getRabbit",value:function(){return new o.rabbitMQ}}]),t}()},function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.rabbitMQ=void 0;var r,o=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),s=e(4),u=null,c=null,a=[];n.rabbitMQ=function(){function t(){return i(this,t),u||(u=this),u}return o(t,[{key:"subscribe",value:function(t){c=t}},{key:"subscribeTopics",value:function(t){var n=t.split(" ");for(var e in n){var i=r.subscribe("/topic/"+n[e],this.on_message);a[n[e]]=i}}},{key:"unsubscribeTopics",value:function(t){a[t].unsubscribe()}},{key:"on_message",value:function(t){console.log(t),c.onMessage(t.body)}},{key:"sendMessage",value:function(t,n){r.send("/topic/"+t,{"content-type":"text/plain"},n)}},{key:"on_connect",value:function(){c.onConnected()}},{key:"on_connect_error",value:function(t){u.connectToRabbit(),c.onDisconnected()}},{key:"connectToRabbit",value:function(){var t=new WebSocket("ws://192.168.1.79:15674/ws");r=s.Stomp.over(t),r.connect("admin","a",this.on_connect,this.on_connect_error,"/")}}]),t}()},function(t,n,e){"use strict";(function(){var t,e,i,r,o={}.hasOwnProperty,s=[].slice;t={LF:"\n",NULL:"\0"},i=function(){function n(t,n,e){this.command=t,this.headers=null!=n?n:{},this.body=null!=e?e:""}var e;return n.prototype.toString=function(){var e,i,r,s,u;e=[this.command],r=!1===this.headers["content-length"],r&&delete this.headers["content-length"],u=this.headers;for(i in u)o.call(u,i)&&(s=u[i],e.push(i+":"+s));return this.body&&!r&&e.push("content-length:"+n.sizeOfUTF8(this.body)),e.push(t.LF+this.body),e.join(t.LF)},n.sizeOfUTF8=function(t){return t?encodeURI(t).match(/%..|./g).length:0},e=function(e){var i,r,o,s,u,c,a,f,l,b,p,h,d,g,v,y,m;for(s=e.search(RegExp(""+t.LF+t.LF)),u=e.substring(0,s).split(t.LF),o=u.shift(),c={},h=function(t){return t.replace(/^\s+|\s+$/g,"")},y=u.reverse(),d=0,v=y.length;d<v;d++)b=y[d],f=b.indexOf(":"),c[h(b.substring(0,f))]=h(b.substring(f+1));if(i="",p=s+2,c["content-length"])l=parseInt(c["content-length"]),i=(""+e).substring(p,p+l);else for(r=null,a=g=p,m=e.length;(p<=m?g<m:g>m)&&(r=e.charAt(a))!==t.NULL;a=p<=m?++g:--g)i+=r;return new n(o,c,i)},n.unmarshall=function(n){var i,r,o,s;return r=n.split(RegExp(""+t.NULL+t.LF+"*")),s={frames:[],partial:""},s.frames=function(){var t,n,o,s;for(o=r.slice(0,-1),s=[],t=0,n=o.length;t<n;t++)i=o[t],s.push(e(i));return s}(),o=r.slice(-1)[0],o===t.LF||-1!==o.search(RegExp(""+t.NULL+t.LF+"*$"))?s.frames.push(e(o)):s.partial=o,s},n.marshall=function(e,i,r){var o;return o=new n(e,i,r),o.toString()+t.NULL},n}(),e=function(){function n(t){this.ws=t,this.ws.binaryType="arraybuffer",this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16384,this.subscriptions={},this.partialData=""}var e;return n.prototype.debug=function(t){var n;return"undefined"!=typeof window&&null!==window&&null!=(n=window.console)?n.log(t):void 0},e=function(){return Date.now?Date.now():(new Date).valueOf},n.prototype._transmit=function(t,n,e){var r;for(r=i.marshall(t,n,e),"function"==typeof this.debug&&this.debug(">>> "+r);;){if(!(r.length>this.maxWebSocketFrameSize))return this.ws.send(r);this.ws.send(r.substring(0,this.maxWebSocketFrameSize)),r=r.substring(this.maxWebSocketFrameSize),"function"==typeof this.debug&&this.debug("remaining = "+r.length)}},n.prototype._setupHeartbeat=function(n){var i,o,s,u,c,a;if((c=n.version)===r.VERSIONS.V1_1||c===r.VERSIONS.V1_2)return a=function(){var t,e,i,r;for(i=n["heart-beat"].split(","),r=[],t=0,e=i.length;t<e;t++)u=i[t],r.push(parseInt(u));return r}(),o=a[0],i=a[1],0!==this.heartbeat.outgoing&&0!==i&&(s=Math.max(this.heartbeat.outgoing,i),"function"==typeof this.debug&&this.debug("send PING every "+s+"ms"),this.pinger=r.setInterval(s,function(n){return function(){return n.ws.send(t.LF),"function"==typeof n.debug?n.debug(">>> PING"):void 0}}(this))),0!==this.heartbeat.incoming&&0!==o?(s=Math.max(this.heartbeat.incoming,o),"function"==typeof this.debug&&this.debug("check PONG every "+s+"ms"),this.ponger=r.setInterval(s,function(t){return function(){var n;if((n=e()-t.serverActivity)>2*s)return"function"==typeof t.debug&&t.debug("did not receive server activity for the last "+n+"ms"),t.ws.close()}}(this))):void 0},n.prototype._parseConnect=function(){var t,n,e,i;switch(t=1<=arguments.length?s.call(arguments,0):[],i={},t.length){case 2:i=t[0],n=t[1];break;case 3:t[1]instanceof Function?(i=t[0],n=t[1],e=t[2]):(i.login=t[0],i.passcode=t[1],n=t[2]);break;case 4:i.login=t[0],i.passcode=t[1],n=t[2],e=t[3];break;default:i.login=t[0],i.passcode=t[1],n=t[2],e=t[3],i.host=t[4]}return[i,n,e]},n.prototype.connect=function(){var n,o,u,c;return n=1<=arguments.length?s.call(arguments,0):[],c=this._parseConnect.apply(this,n),u=c[0],this.connectCallback=c[1],o=c[2],"function"==typeof this.debug&&this.debug("Opening Web Socket..."+this.ws),this.ws.onmessage=function(n){return function(r){var s,u,c,a,f,l,b,p,h,d,g,v,y;if(a="undefined"!=typeof ArrayBuffer&&r.data instanceof ArrayBuffer?(s=new Uint8Array(r.data),"function"==typeof n.debug&&n.debug("--- got data length: "+s.length),function(){var t,n,e;for(e=[],t=0,n=s.length;t<n;t++)u=s[t],e.push(String.fromCharCode(u));return e}().join("")):r.data,n.serverActivity=e(),a===t.LF)return void("function"==typeof n.debug&&n.debug("<<< PONG"));for("function"==typeof n.debug&&n.debug("<<< "+a),h=i.unmarshall(n.partialData+a),n.partialData=h.partial,v=h.frames,y=[],d=0,g=v.length;d<g;d++)switch(f=v[d],f.command){case"CONNECTED":"function"==typeof n.debug&&n.debug("connected to server "+f.headers.server),n.connected=!0,n._setupHeartbeat(f.headers),y.push("function"==typeof n.connectCallback?n.connectCallback(f):void 0);break;case"MESSAGE":p=f.headers.subscription,b=n.subscriptions[p]||n.onreceive,b?(c=n,l=f.headers["message-id"],f.ack=function(t){return null==t&&(t={}),c.ack(l,p,t)},f.nack=function(t){return null==t&&(t={}),c.nack(l,p,t)},y.push(b(f))):y.push("function"==typeof n.debug?n.debug("Unhandled received MESSAGE: "+f):void 0);break;case"RECEIPT":y.push("function"==typeof n.onreceipt?n.onreceipt(f):void 0);break;case"ERROR":y.push("function"==typeof o?o(f):void 0);break;default:y.push("function"==typeof n.debug?n.debug("Unhandled frame: "+f):void 0)}return y}}(this),this.ws.onclose=function(t){return function(){var n;return n="Whoops! Lost connection to "+t.ws.url,"function"==typeof t.debug&&t.debug(n),t._cleanUp(),"function"==typeof o?o(n):void 0}}(this),this.ws.onopen=function(t){return function(){return"function"==typeof t.debug&&t.debug("Web Socket Opened..."),u["accept-version"]=r.VERSIONS.supportedVersions(),u["heart-beat"]=[t.heartbeat.outgoing,t.heartbeat.incoming].join(","),t._transmit("CONNECT",u)}}(this)},n.prototype.disconnect=function(t,n){return null==n&&(n={}),this._transmit("DISCONNECT",n),this.ws.onclose=null,this.ws.close(),this._cleanUp(),"function"==typeof t?t():void 0},n.prototype._cleanUp=function(){if(this.connected=!1,this.pinger&&r.clearInterval(this.pinger),this.ponger)return r.clearInterval(this.ponger)},n.prototype.send=function(t,n,e){return null==n&&(n={}),null==e&&(e=""),n.destination=t,this._transmit("SEND",n,e)},n.prototype.subscribe=function(t,n,e){var i;return null==e&&(e={}),e.id||(e.id="sub-"+this.counter++),e.destination=t,this.subscriptions[e.id]=n,this._transmit("SUBSCRIBE",e),i=this,{id:e.id,unsubscribe:function(){return i.unsubscribe(e.id)}}},n.prototype.unsubscribe=function(t){return delete this.subscriptions[t],this._transmit("UNSUBSCRIBE",{id:t})},n.prototype.begin=function(t){var n,e;return e=t||"tx-"+this.counter++,this._transmit("BEGIN",{transaction:e}),n=this,{id:e,commit:function(){return n.commit(e)},abort:function(){return n.abort(e)}}},n.prototype.commit=function(t){return this._transmit("COMMIT",{transaction:t})},n.prototype.abort=function(t){return this._transmit("ABORT",{transaction:t})},n.prototype.ack=function(t,n,e){return null==e&&(e={}),e["message-id"]=t,e.subscription=n,this._transmit("ACK",e)},n.prototype.nack=function(t,n,e){return null==e&&(e={}),e["message-id"]=t,e.subscription=n,this._transmit("NACK",e)},n}(),r={VERSIONS:{V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.1,1.0"}},client:function(t,n){var i,o;return null==n&&(n=["v10.stomp","v11.stomp"]),i=r.WebSocketClass||WebSocket,o=new i(t,n),new e(o)},over:function(t){return new e(t)},Frame:i},void 0!==n&&null!==n&&(n.Stomp=r),"undefined"!=typeof window&&null!==window?(r.setInterval=function(t,n){return window.setInterval(n,t)},r.clearInterval=function(t){return window.clearInterval(t)},window.Stomp=r):n||(self.Stomp=r)}).call(void 0)}])});